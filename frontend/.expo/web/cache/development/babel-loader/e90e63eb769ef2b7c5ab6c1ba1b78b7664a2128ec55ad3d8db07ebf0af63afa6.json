{"ast":null,"code":"import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport axios from 'axios';\nimport Platform from \"react-native-web/dist/exports/Platform\";\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nvar API_BASE_URL = Platform.OS === 'android' ? 'http://10.0.2.2:5000/api' : 'http://localhost:5000/api';\nvar api = axios.create({\n  baseURL: API_BASE_URL,\n  headers: {\n    'Content-Type': 'application/json'\n  }\n});\napi.interceptors.request.use(function () {\n  var _ref = _asyncToGenerator(function* (config) {\n    var token = yield AsyncStorage.getItem('token');\n    if (token) {\n      config.headers.Authorization = \"Bearer \" + token;\n    }\n    return config;\n  });\n  return function (_x) {\n    return _ref.apply(this, arguments);\n  };\n}(), function (error) {\n  return Promise.reject(error);\n});\napi.interceptors.response.use(function (response) {\n  return response;\n}, function () {\n  var _ref2 = _asyncToGenerator(function* (error) {\n    var _error$response;\n    var originalRequest = error.config;\n    if (((_error$response = error.response) == null ? void 0 : _error$response.status) === 401 && !originalRequest._retry) {\n      originalRequest._retry = true;\n      try {\n        yield AsyncStorage.clear();\n        return Promise.reject(error);\n      } catch (refreshError) {\n        yield AsyncStorage.clear();\n        return Promise.reject(refreshError);\n      }\n    }\n    return Promise.reject(error);\n  });\n  return function (_x2) {\n    return _ref2.apply(this, arguments);\n  };\n}());\nexport default api;\nexport var authAPI = {\n  login: function login(data) {\n    return api.post('/auth/login', data);\n  },\n  register: function register(data) {\n    return api.post('/auth/register', data);\n  },\n  verifyOTP: function verifyOTP(data) {\n    return api.post('/auth/verify-otp', data);\n  },\n  getProfile: function getProfile() {\n    return api.get('/auth/profile');\n  },\n  updateProfile: function updateProfile(data) {\n    return api.put('/auth/profile', data);\n  },\n  changeLanguage: function changeLanguage(language) {\n    return api.put('/auth/language', {\n      language: language\n    });\n  }\n};\nexport var marketAPI = {\n  getCrops: function getCrops(params) {\n    return api.get('/market/crops', {\n      params: params\n    });\n  },\n  getCropDetails: function getCropDetails(id) {\n    return api.get(\"/market/crops/\" + id);\n  },\n  listCrop: function listCrop(data) {\n    return api.post('/market/crops/list', data);\n  },\n  placeBid: function placeBid(data) {\n    return api.post('/market/bids', data);\n  },\n  respondToBid: function respondToBid(data) {\n    return api.post('/market/bids/respond', data);\n  },\n  getPriceHistory: function getPriceHistory(params) {\n    return api.get('/market/prices/history', {\n      params: params\n    });\n  }\n};\nexport var mlAPI = {\n  getPricePrediction: function getPricePrediction(data) {\n    return api.post('/ml/predict-price', data);\n  },\n  getMarketInsights: function getMarketInsights(data) {\n    return api.post('/ml/insights', data);\n  },\n  getCropRecommendation: function getCropRecommendation(data) {\n    return api.post('/ml/recommend-crop', data);\n  }\n};\nexport var governmentAPI = {\n  getSchemes: function getSchemes() {\n    return api.get('/government/schemes');\n  },\n  applyForScheme: function applyForScheme(schemeId) {\n    return api.post(\"/government/schemes/\" + schemeId + \"/apply\");\n  }\n};","map":{"version":3,"names":["axios","Platform","AsyncStorage","API_BASE_URL","OS","api","create","baseURL","headers","interceptors","request","use","_ref","_asyncToGenerator","config","token","getItem","Authorization","_x","apply","arguments","error","Promise","reject","response","_ref2","_error$response","originalRequest","status","_retry","clear","refreshError","_x2","authAPI","login","data","post","register","verifyOTP","getProfile","get","updateProfile","put","changeLanguage","language","marketAPI","getCrops","params","getCropDetails","id","listCrop","placeBid","respondToBid","getPriceHistory","mlAPI","getPricePrediction","getMarketInsights","getCropRecommendation","governmentAPI","getSchemes","applyForScheme","schemeId"],"sources":["C:/Users/vamsi/Desktop/DeepseekM5/frontend/src/services/api.js"],"sourcesContent":["import axios from 'axios';\r\nimport { Platform } from 'react-native';\r\nimport AsyncStorage from '@react-native-async-storage/async-storage';\r\n\r\n// Use localhost for Android emulator (10.0.2.2) or local IP for physical device\r\n// If running on a physical device, replace '10.0.2.2' with your computer's local IP (e.g., 192.168.1.5)\r\n// const LOCAL_IP = '192.168.1.x'; \r\nconst API_BASE_URL = Platform.OS === 'android'\r\n    ? 'http://10.0.2.2:5000/api' // Change this to http://${LOCAL_IP}:5000/api for physical device\r\n    : 'http://localhost:5000/api';\r\n\r\nconst api = axios.create({\r\n    baseURL: API_BASE_URL,\r\n    headers: {\r\n        'Content-Type': 'application/json'\r\n    }\r\n});\r\n\r\n// Request interceptor to add token\r\napi.interceptors.request.use(\r\n    async (config) => {\r\n        const token = await AsyncStorage.getItem('token');\r\n        if (token) {\r\n            config.headers.Authorization = `Bearer ${token}`;\r\n        }\r\n        return config;\r\n    },\r\n    (error) => {\r\n        return Promise.reject(error);\r\n    }\r\n);\r\n\r\n// Response interceptor to handle errors\r\napi.interceptors.response.use(\r\n    (response) => response,\r\n    async (error) => {\r\n        const originalRequest = error.config;\r\n\r\n        // If token expired, try to refresh\r\n        if (error.response?.status === 401 && !originalRequest._retry) {\r\n            originalRequest._retry = true;\r\n\r\n            try {\r\n                // Implement token refresh logic here if backend supports it\r\n                /*\r\n                const refreshToken = await AsyncStorage.getItem('refreshToken');\r\n                if (refreshToken) {\r\n                  const response = await axios.post(`${API_BASE_URL}/auth/refresh`, {\r\n                    refreshToken\r\n                  });\r\n                  const { token } = response.data;\r\n                  await AsyncStorage.setItem('token', token);\r\n                  originalRequest.headers.Authorization = `Bearer ${token}`;\r\n                  return api(originalRequest);\r\n                }\r\n                */\r\n                // For now, just logout\r\n                await AsyncStorage.clear();\r\n                return Promise.reject(error);\r\n            } catch (refreshError) {\r\n                // Clear storage and redirect to login\r\n                await AsyncStorage.clear();\r\n                return Promise.reject(refreshError);\r\n            }\r\n        }\r\n\r\n        return Promise.reject(error);\r\n    }\r\n);\r\n\r\nexport default api;\r\n\r\n// API functions for different endpoints\r\nexport const authAPI = {\r\n    login: (data) => api.post('/auth/login', data),\r\n    register: (data) => api.post('/auth/register', data),\r\n    verifyOTP: (data) => api.post('/auth/verify-otp', data),\r\n    getProfile: () => api.get('/auth/profile'),\r\n    updateProfile: (data) => api.put('/auth/profile', data),\r\n    changeLanguage: (language) => api.put('/auth/language', { language })\r\n};\r\n\r\nexport const marketAPI = {\r\n    getCrops: (params) => api.get('/market/crops', { params }),\r\n    getCropDetails: (id) => api.get(`/market/crops/${id}`),\r\n    listCrop: (data) => api.post('/market/crops/list', data),\r\n    placeBid: (data) => api.post('/market/bids', data),\r\n    respondToBid: (data) => api.post('/market/bids/respond', data),\r\n    getPriceHistory: (params) => api.get('/market/prices/history', { params })\r\n};\r\n\r\nexport const mlAPI = {\r\n    getPricePrediction: (data) => api.post('/ml/predict-price', data),\r\n    getMarketInsights: (data) => api.post('/ml/insights', data),\r\n    getCropRecommendation: (data) => api.post('/ml/recommend-crop', data)\r\n};\r\n\r\nexport const governmentAPI = {\r\n    getSchemes: () => api.get('/government/schemes'),\r\n    applyForScheme: (schemeId) => api.post(`/government/schemes/${schemeId}/apply`)\r\n};\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}