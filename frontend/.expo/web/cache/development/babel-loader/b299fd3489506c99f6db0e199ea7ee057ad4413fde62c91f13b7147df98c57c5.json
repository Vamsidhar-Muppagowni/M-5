{"ast":null,"code":"import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport { createSlice, createAsyncThunk } from '@reduxjs/toolkit';\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nimport api from \"../../services/api\";\nexport var login = createAsyncThunk('auth/login', function () {\n  var _ref3 = _asyncToGenerator(function* (_ref, _ref2) {\n    var phone = _ref.phone,\n      password = _ref.password;\n    var rejectWithValue = _ref2.rejectWithValue;\n    try {\n      var response = yield api.post('/auth/login', {\n        phone: phone,\n        password: password\n      });\n      yield AsyncStorage.setItem('token', response.data.token);\n      yield AsyncStorage.setItem('user', JSON.stringify(response.data.user));\n      return response.data;\n    } catch (error) {\n      var _error$response, _error$response$data;\n      return rejectWithValue(((_error$response = error.response) == null ? void 0 : (_error$response$data = _error$response.data) == null ? void 0 : _error$response$data.error) || 'Login failed');\n    }\n  });\n  return function (_x, _x2) {\n    return _ref3.apply(this, arguments);\n  };\n}());\nexport var register = createAsyncThunk('auth/register', function () {\n  var _ref5 = _asyncToGenerator(function* (userData, _ref4) {\n    var rejectWithValue = _ref4.rejectWithValue;\n    try {\n      console.log(\"AuthSlice: Calling API register with\", userData);\n      var response = yield api.post('/auth/register', userData);\n      console.log(\"AuthSlice: API Response\", response.data);\n      return response.data;\n    } catch (error) {\n      var _error$response2, _error$response3, _error$response3$data;\n      console.error(\"AuthSlice: API Error\", ((_error$response2 = error.response) == null ? void 0 : _error$response2.data) || error.message);\n      return rejectWithValue(((_error$response3 = error.response) == null ? void 0 : (_error$response3$data = _error$response3.data) == null ? void 0 : _error$response3$data.error) || 'Registration failed');\n    }\n  });\n  return function (_x3, _x4) {\n    return _ref5.apply(this, arguments);\n  };\n}());\nexport var verifyOTP = createAsyncThunk('auth/verifyOTP', function () {\n  var _ref8 = _asyncToGenerator(function* (_ref6, _ref7) {\n    var phone = _ref6.phone,\n      otp = _ref6.otp;\n    var rejectWithValue = _ref7.rejectWithValue;\n    try {\n      var response = yield api.post('/auth/verify-otp', {\n        phone: phone,\n        otp: otp\n      });\n      return response.data;\n    } catch (error) {\n      var _error$response4, _error$response4$data;\n      return rejectWithValue(((_error$response4 = error.response) == null ? void 0 : (_error$response4$data = _error$response4.data) == null ? void 0 : _error$response4$data.error) || 'Verification failed');\n    }\n  });\n  return function (_x5, _x6) {\n    return _ref8.apply(this, arguments);\n  };\n}());\nvar authSlice = createSlice({\n  name: 'auth',\n  initialState: {\n    user: null,\n    token: null,\n    isLoading: false,\n    error: null,\n    isAuthenticated: false\n  },\n  reducers: {\n    logout: function logout(state) {\n      state.user = null;\n      state.token = null;\n      state.isAuthenticated = false;\n      AsyncStorage.removeItem('token');\n      AsyncStorage.removeItem('user');\n    },\n    setUser: function setUser(state, action) {\n      state.user = action.payload.user;\n      state.token = action.payload.token;\n      state.isAuthenticated = true;\n    },\n    clearError: function clearError(state) {\n      state.error = null;\n    }\n  },\n  extraReducers: function extraReducers(builder) {\n    builder.addCase(login.pending, function (state) {\n      state.isLoading = true;\n      state.error = null;\n    }).addCase(login.fulfilled, function (state, action) {\n      state.isLoading = false;\n      state.user = action.payload.user;\n      state.token = action.payload.token;\n      state.isAuthenticated = true;\n    }).addCase(login.rejected, function (state, action) {\n      state.isLoading = false;\n      state.error = action.payload;\n    }).addCase(register.pending, function (state) {\n      state.isLoading = true;\n      state.error = null;\n    }).addCase(register.fulfilled, function (state) {\n      state.isLoading = false;\n    }).addCase(register.rejected, function (state, action) {\n      state.isLoading = false;\n      state.error = action.payload;\n    }).addCase(verifyOTP.pending, function (state) {\n      state.isLoading = true;\n      state.error = null;\n    }).addCase(verifyOTP.fulfilled, function (state) {\n      state.isLoading = false;\n    }).addCase(verifyOTP.rejected, function (state, action) {\n      state.isLoading = false;\n      state.error = action.payload;\n    });\n  }\n});\nvar _authSlice$actions = authSlice.actions,\n  logout = _authSlice$actions.logout,\n  setUser = _authSlice$actions.setUser,\n  clearError = _authSlice$actions.clearError;\nexport { logout, setUser, clearError };\nexport default authSlice.reducer;","map":{"version":3,"names":["createSlice","createAsyncThunk","AsyncStorage","api","login","_ref3","_asyncToGenerator","_ref","_ref2","phone","password","rejectWithValue","response","post","setItem","data","token","JSON","stringify","user","error","_error$response","_error$response$data","_x","_x2","apply","arguments","register","_ref5","userData","_ref4","console","log","_error$response2","_error$response3","_error$response3$data","message","_x3","_x4","verifyOTP","_ref8","_ref6","_ref7","otp","_error$response4","_error$response4$data","_x5","_x6","authSlice","name","initialState","isLoading","isAuthenticated","reducers","logout","state","removeItem","setUser","action","payload","clearError","extraReducers","builder","addCase","pending","fulfilled","rejected","_authSlice$actions","actions","reducer"],"sources":["C:/Users/vamsi/Desktop/DeepseekM5/frontend/src/store/slices/authSlice.js"],"sourcesContent":["import { createSlice, createAsyncThunk } from '@reduxjs/toolkit';\r\nimport AsyncStorage from '@react-native-async-storage/async-storage';\r\nimport api from '../../services/api';\r\n\r\nexport const login = createAsyncThunk(\r\n    'auth/login',\r\n    async ({ phone, password }, { rejectWithValue }) => {\r\n        try {\r\n            const response = await api.post('/auth/login', { phone, password });\r\n            await AsyncStorage.setItem('token', response.data.token);\r\n            await AsyncStorage.setItem('user', JSON.stringify(response.data.user));\r\n            return response.data;\r\n        } catch (error) {\r\n            return rejectWithValue(error.response?.data?.error || 'Login failed');\r\n        }\r\n    }\r\n);\r\n\r\nexport const register = createAsyncThunk(\r\n    'auth/register',\r\n    async (userData, { rejectWithValue }) => {\r\n        try {\r\n            console.log(\"AuthSlice: Calling API register with\", userData);\r\n            const response = await api.post('/auth/register', userData);\r\n            console.log(\"AuthSlice: API Response\", response.data);\r\n            return response.data;\r\n        } catch (error) {\r\n            console.error(\"AuthSlice: API Error\", error.response?.data || error.message);\r\n            return rejectWithValue(error.response?.data?.error || 'Registration failed');\r\n        }\r\n    }\r\n);\r\n\r\nexport const verifyOTP = createAsyncThunk(\r\n    'auth/verifyOTP',\r\n    async ({ phone, otp }, { rejectWithValue }) => {\r\n        try {\r\n            const response = await api.post('/auth/verify-otp', { phone, otp });\r\n            return response.data;\r\n        } catch (error) {\r\n            return rejectWithValue(error.response?.data?.error || 'Verification failed');\r\n        }\r\n    }\r\n);\r\n\r\nconst authSlice = createSlice({\r\n    name: 'auth',\r\n    initialState: {\r\n        user: null,\r\n        token: null,\r\n        isLoading: false,\r\n        error: null,\r\n        isAuthenticated: false\r\n    },\r\n    reducers: {\r\n        logout: (state) => {\r\n            state.user = null;\r\n            state.token = null;\r\n            state.isAuthenticated = false;\r\n            AsyncStorage.removeItem('token');\r\n            AsyncStorage.removeItem('user');\r\n        },\r\n        setUser: (state, action) => {\r\n            state.user = action.payload.user;\r\n            state.token = action.payload.token;\r\n            state.isAuthenticated = true;\r\n        },\r\n        clearError: (state) => {\r\n            state.error = null;\r\n        }\r\n    },\r\n    extraReducers: (builder) => {\r\n        builder\r\n            .addCase(login.pending, (state) => {\r\n                state.isLoading = true;\r\n                state.error = null;\r\n            })\r\n            .addCase(login.fulfilled, (state, action) => {\r\n                state.isLoading = false;\r\n                state.user = action.payload.user;\r\n                state.token = action.payload.token;\r\n                state.isAuthenticated = true;\r\n            })\r\n            .addCase(login.rejected, (state, action) => {\r\n                state.isLoading = false;\r\n                state.error = action.payload;\r\n            })\r\n            .addCase(register.pending, (state) => {\r\n                state.isLoading = true;\r\n                state.error = null;\r\n            })\r\n            .addCase(register.fulfilled, (state) => {\r\n                state.isLoading = false;\r\n            })\r\n            .addCase(register.rejected, (state, action) => {\r\n                state.isLoading = false;\r\n                state.error = action.payload;\r\n            })\r\n            .addCase(verifyOTP.pending, (state) => {\r\n                state.isLoading = true;\r\n                state.error = null;\r\n            })\r\n            .addCase(verifyOTP.fulfilled, (state) => {\r\n                state.isLoading = false;\r\n            })\r\n            .addCase(verifyOTP.rejected, (state, action) => {\r\n                state.isLoading = false;\r\n                state.error = action.payload;\r\n            });\r\n    }\r\n});\r\n\r\nexport const { logout, setUser, clearError } = authSlice.actions;\r\nexport default authSlice.reducer;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}